{% extends 'base.html' %}

{% block title %}{{ action }} Incident{% endblock %}

{% block content %}
<div class="row">
  <div class="col s12 m10 offset-m1 l8 offset-l2">
    <div class="card">
      <div class="card-content">
        <span class="card-title">{{ action }} Incident</span>

        <form method="POST" enctype="multipart/form-data">
          {% csrf_token %}

          {% for field in form %}
            {% if field.name == 'is_active' %}
              <!-- Active Status Checkbox with extra spacing -->
              <div class="section" style="margin-top: 30px;">
                <label>
                  {{ field }}
                  <span>{{ field.label }}</span>
                </label>
                {% if field.errors %}
                  <span class="helper-text red-text">
                    {% for error in field.errors %}{{ error }}{% endfor %}
                  </span>
                {% endif %}
                {% if field.help_text %}
                  <span class="helper-text">{{ field.help_text }}</span>
                {% endif %}
              </div>
            {% elif field.name == 'screenshot' %}
              <!-- Screenshot Field with extra spacing -->
              <div class="file-field input-field" style="margin-top: 30px;">
                <div class="btn blue darken-2">
                  <span>Upload Screenshot</span>
                  {{ field }}
                </div>
                <div class="file-path-wrapper">
                  <input class="file-path validate" type="text" placeholder="Optional">
                </div>
                {% if field.errors %}
                  <span class="helper-text red-text">
                    {% for error in field.errors %}{{ error }}{% endfor %}
                  </span>
                {% endif %}
                {% if field.help_text %}
                  <span class="helper-text">{{ field.help_text }}</span>
                {% endif %}
              </div>
            {% else %}
              <!-- Regular fields -->
              <div class="input-field" style="margin-top: 20px;">
                {{ field }}
                <label for="{{ field.id_for_label }}" class="{% if field.value %}active{% endif %}">{{ field.label }}</label>
                {% if field.errors %}
                  <span class="helper-text red-text">
                    {% for error in field.errors %}{{ error }}{% endfor %}
                  </span>
                {% endif %}
                {% if field.help_text %}
                  <span class="helper-text">{{ field.help_text }}</span>
                {% endif %}
              </div>
            {% endif %}
          {% endfor %}

          <div class="card-action" style="margin-top: 30px;">
            <button type="submit" class="btn blue darken-2 waves-effect waves-light">
              <i class="material-icons left">save</i>{{ action }}
            </button>
            <a href="{% url 'incident_list' %}" class="btn-flat">Cancel</a>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

{% block extra_js %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    var elems = document.querySelectorAll('select');
    M.FormSelect.init(elems);
  });
</script>
{% endblock %}
{% endblock %}
